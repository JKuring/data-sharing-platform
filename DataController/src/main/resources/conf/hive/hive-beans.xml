<?xml version="1.0" encoding="UTF-8"?>
<hive:beans xmlns:hive="http://www.springframework.org/schema/beans"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xmlns:hdp="http://www.springframework.org/schema/hadoop"
            xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/hadoop http://www.springframework.org/schema/hadoop/spring-hadoop.xsd">

    <!--配置hive DataSource-->
    <!-- prototype 保证每次请求都是新的连接不超时，loginTimeout 保证连接自动断不积压连接 60 seconds-->
    <hive:bean id="hiveDriver" class="org.apache.hive.jdbc.HiveDriver"/>
    <hive:bean id="hiveDataSource" class="org.springframework.jdbc.datasource.SimpleDriverDataSource">
        <hive:constructor-arg name="driver" ref="hiveDriver"/>
        <hive:constructor-arg name="url" value="jdbc:hive2://YP-HDP-APOLLO4200-6026:10000/default;principal=hive/YP-HDP-APOLLO4200-6026@BCHKDC"/>
    </hive:bean>

    <!-- 配置HiveCP-->
    <!-- org.springframework.data.hadoop.hive.HiveClientFactory
    具体实现public HiveClient(DataSource dataSource) {this.jdbcTemplate = new JdbcTemplate(dataSource);}
    每一次请求都会new 一个JdbcTemplate的hive jdbc connection-->
    <hdp:hive-client-factory id="hiveClientFactory" hive-data-source-ref="hiveDataSource"/>

    <hdp:hive-template id="hiveTemplate" hive-client-factory-ref="hiveClientFactory"/>

    <hive:bean id="hiveDao" class="com.eastcom.datacontroller.dao.HiveDaoImpl"/>

    <!-- dropping statement -->
    <hive:bean id="dropPartitionTemp" class="java.lang.String">
        <hive:constructor-arg name="value" value="alter table [tableName] drop partition([partitionName])"/>
    </hive:bean>

    <!--Controller-->
    <hive:bean id="DELETE_TABLE_HIVE" class="com.eastcom.datacontroller.service.HiveDeletePatitionController"/>

    <hive:bean id="hiveEntity" class="com.eastcom.datacontroller.bean.HiveEntityImpl"/>

</hive:beans>